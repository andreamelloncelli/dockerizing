#ERROR Remoting: org.apache.spark.deploy.ApplicationDescription; local class incompatible: stream classdesc serialVersionUID = -7685200927816255400, local class serialVersionUID = 2596819202403185464

###############################################
## A SPARK standalone cluster
# https://spark.apache.org/docs/latest/spark-standalone.html

master:
    image: pdonorio/spark
    command: spark-class org.apache.spark.deploy.master.Master
    hostname: master
    environment:
        SPARK_MASTER_HOST: master
    ports:
        - 8080:8080

worker:
    image: pdonorio/spark
    command: spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker
    environment:
        SPARK_WORKER_CORES: 2
        SPARK_WORKER_MEMORY: 1g
        SPARK_WORKER_WEBUI_PORT: 8081
    #SPARK_WORKER_PORT: 8881
    links:
        - master
        # - client
    # expose:
    #     - 8881
    ports:
        - 8081:8081
    volumes:
        - ./data:/data

####################################################
#https://hub.docker.com/r/jupyter/pyspark-notebook/
client:
    #command: sleep 123456789
    image: jupyter/all-spark-notebook
#Â SCALA?
    #image: jupyter/pyspark-notebook
    hostname: ipyspark
    environment:
        #MASTER: spark://master:7077
        # USE_HTTPS: yes
        PASSWORD: mytest
    ports:
        - 80:8888
    links:
        - master
    volumes:
        - ./data/nbs:/home/jovyan/work
        - ./data:/data

####################################################
